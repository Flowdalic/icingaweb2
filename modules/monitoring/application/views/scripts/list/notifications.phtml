<div class="controls">
<?= $this->tabs ?>
<div style="margin: 1em" class="dontprint">
Sort by <?=  $this->sortControl->render($this) ?>

<?= $this->selectionToolbar('single') ?>
</div>
<?=  $this->paginationControl($notifications, null, null, array('preserve' => $this->preserve)) ?>
</div>

<div class="content">
<?php

if (empty($this->notifications)) {
    echo 'No notifications yet</div>';
    return;
}
?>

<table data-base-target="_next" class="action">
<tbody>
<?php

foreach ($notifications as $notification):

  if (isset($notification->service)) {
      $isService = true;
      $href = $this->href('monitoring/show/service', array(
          'host'    => $notification->host,
          'service' => $notification->service
      ));
      $stateName = strtolower($this->util()->getServiceStateName($notification->notification_state));
  } else {
      $isService = false;
      $href = $this->href('monitoring/show/host', array(
          'host'    => $notification->host
      ));
      $stateName = strtolower($this->util()->getHostStateName($notification->notification_state));
  }
  ?>
  <tr class="state <?= $stateName ?>">
      <td class="state"><?= $this->timeSince($notification->notification_start_time) ?></td>
      <td>
          <?php if ($isService): ?>
              <a href="<?= $href ?>"><?= $notification->service ?></a>
              <small>
                  on <?= $notification->host ?>
              </small>
              <?php $isService = true; ?>
          <?php else: ?>
              <a href="<?= $href ?>"><?= $notification->host ?></a>
          <?php endif; ?>
          <br />
          <?= $this->escape(substr(strip_tags($notification->notification_output), 0, 10000)); ?>
          <br />
          <small>
              Sent to
              <a href="<?= $this->href('monitoring/show/contact', array('contact' => $notification->notification_contact)); ?>">
                  <?= $notification->notification_contact ?>
              </a>
          </small>
      </td>
  </tr>
<?php endforeach ?>
</tbody>
</table>

</div>
