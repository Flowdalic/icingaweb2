<?php

if ($hosts->count() === 0) {
    echo '<p>No host found</p>';
    return;
}

?><table
    data-base-target="_next"
    class="action multiselect"
    data-icinga-multiselect-url="<?= $this->href("/monitoring/multi/host") ?>"
    data-icinga-multiselect-data="host"
>
<tbody>
<?php

$helper = $this->getHelper('MonitoringState');
foreach($hosts as $host):

    $hostStateName = strtolower($this->util()->getHostStateName($host->host_state));
    $hostLink = $this->href('monitoring/show/host', array('host' => $host->host_name));

?>
  <tr class="state <?= $hostStateName ?><?= $host->host_handled ? ' handled' : '' ?>">

    <!-- Icons -->
<!--    <td>
      <?php if (!$host->host_handled && $host->host_state > 0): ?>
      <a href="#" title="Unhandled">
        <i class="icon-table icinga-icon-unhandled"></i>
      </a>
      <?php endif; ?>

      <?php if ($host->host_acknowledged && !$host->host_in_downtime): ?>
      <a href="#" title="Acknowledged">
        <i class="icon-table icinga-icon-acknowledgement"></i>
      </a>
      <?php endif; ?>

      <?php if ($host->host_is_flapping): ?>
      <a href="#" title="Flapping">
        <i class="icon-table icinga-icon-flapping"></i>
      </a>
      <?php endif; ?>

      <?php if (!$host->host_notifications_enabled): ?>
      <a href="#" title="Notifications Disabled">
        <i class="icon-table icinga-icon-notification-disabled"></i>
      </a>
      <?php endif; ?>

      <?php if ($host->host_in_downtime): ?>
      <a href="#" title="In Downtime">
        <i class="icon-table icinga-icon-in-downtime"></i>
      </a>
      <?php endif; ?>

      <?php if (!$host->host_active_checks_enabled): ?>
      <?php if (!$host->host_passive_checks_enabled): ?>
      <a href="#" title="Active And Passive Checks Disabled">
        <i class="icinga-icon-active-passive-checks-disabled"></i>
      </a>
      <?php else: ?>
      <a href="#" title="Active Checks Disabled">
        <i class="icon-table icinga-icon-active-checks-disabled"></i>
      </a>
      <?php endif; ?>
      <?php endif; ?>

      <?php if (isset($host->host_last_comment) && $host->host_last_comment !== null): ?>
      <a href="#" title="Comments">
        <i class="icon-table icinga-icon-comment"></i>
      </a>
      <?php endif; ?>
    </td>
-->
    <!-- State -->
    <td title="<?= $helper->getStateTitle($host, 'host') ?>" class="state">
      <?= $this->timeSince($host->host_last_state_change) ?>
    </td>
    <td>
      <a href="<?= $hostLink ?>"><?= $host->host_name ?></a><br />
      <?= $this->escape(substr(strip_tags($host->host_output), 0, 10000)); ?>
    </td>
  </tr>
<?php endforeach ?>
</tbody>
</table>
